@model TaxBarAssociation.Models.BlogDetails
@{
    ViewData["Title"] = "AddBlog";
    Layout = "~/Views/Shared/_Dashboard.cshtml";
}
<style>

.card-title {
    font-size: 14px !important;
}

.card-header {
    border-radius: 0 !important;
    padding: 0.6rem 0.5rem !important;
}

.card-danger:not(.card-outline)>.card-header {
    background-color: #4b545c !important;
}

.card-body {
    padding: 0.5rem !important;
}

label {
    margin-bottom: 0 !important;
}

#the-count {
    float: right;
    padding: 0.1rem 0 0 0;
    font-size: 0.875rem;
}

#cke_20,
#cke_21,
#cke_22,
#cke_23,
#cke_24,
#cke_25,
#cke_26,
#cke_34,
#cke_39,
#cke_76,
.n1ed_top_right_block,
.jsplus_ui_be_quick_panel {
    display: none !important;
}

.FileManager__noticeDemoServer {
    display: none !important;
}

#CategoryList {
    list-style: none;
    margin: 0;
    padding: 0 0 0 5px;
}

    #CategoryList > li {
        display: block;
    }

input[type=checkbox] {
    cursor: pointer;
    margin: 0 0.5rem 0 0;
    position: relative;
    top: 0;
}

    input[type=checkbox]:checked:before {
        transform: rotate(-45deg) scale(1);
    }

    input[type=checkbox]:before {
        border-color: #58b3f0;
        border-style: none none solid solid;
        border-width: 2px;
        content: "";
        height: 5px;
        left: 1px;
        margin: auto;
        position: absolute;
        right: 0;
        top: 0.2em;
        transform: rotate(-45deg) scale(0);
        transition: transform .4s cubic-bezier(.45, 1.8, .5, .75);
        width: 10px;
        z-index: 1;
    }

    input[type=checkbox]:checked:after {
        border-color: #58b3f0;
    }

    input[type=checkbox]:after {
        background: #fff;
        border: 1px solid #c4cdd5;
        border-radius: 3px;
        bottom: 0;
        content: "";
        cursor: pointer;
        height: 16px;
        left: -1px;
        margin: auto;
        position: absolute;
        right: 0;
        top: 0;
        width: 16px;
    }

#CategoryList > li > label {
    display: inline-block;
    font-weight: 400 !important;
}

.preview-image-wrapper {
    background: #fafbfc;
    border: 1px solid rgba(195, 207, 216, .3);
    display: inline-block;
    height: 150px;
    max-height: 150px;
    max-width: 150px;
    min-height: 150px;
    min-width: 150px;
    overflow: hidden;
    position: relative;
    text-align: center;
    vertical-align: middle;
    width: 150px;
}

    .preview-image-wrapper img {
        height: 150px;
        max-width: 100%;
    }

.btn_remove_image,
.btn_remove {
    background: #ddd;
    border-radius: 50% !important;
    color: #000;
    display: inline-block;
    font-size: 18px;
    height: 30px;
    line-height: 30px;
    position: absolute;
    right: 5px;
    text-align: center;
    top: 5px;
    width: 30px;
}

.image-box-actions a {
    color: #337ab7 !important;
    text-shadow: none !important;
}

.onoffswitch {
    position: relative;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    width: 45px;
}

.onoffswitch-label {
    border: 2px solid #e6e6e6;
    border-radius: 20px !important;
    -webkit-border-radius: 20px !important;
    -moz-border-radius: 20px !important;
    cursor: pointer;
    display: block;
    overflow: hidden;
}

.onoffswitch-switch {
    background: #a1a1a1;
    border: 2px solid #e6e6e6;
    border-radius: 50% !important;
    bottom: 0;
    height: 20px;
    margin: 0;
    position: absolute;
    right: 26px;
    top: 0;
    transition: all .3s ease-in 0s;
    width: 20px;
}

.onoffswitch-checkbox:checked + .onoffswitch-label .onoffswitch-switch {
    background-color: #d64635;
    right: 0;
}

.onoffswitch-label .onoffswitch-inner {
    margin-left: 0;
}

.onoffswitch-inner {
    margin-left: -100%;
    transition: margin .3s ease-in 0s;
    width: 200%;
}

    .onoffswitch-inner:before {
        background-color: #eee;
        color: #e6e6e6;
        content: "";
        padding-left: 10px;
    }

    .onoffswitch-inner:after,
    .onoffswitch-inner:before {
        box-sizing: border-box;
        color: #fff;
        float: left;
        font-size: 15px;
        font-weight: 700;
        height: 15px;
        line-height: 15px;
        padding: 0;
        width: 50%;
    }

    .onoffswitch-inner:after {
        background-color: #eee;
        color: #a38282;
        content: "";
        padding-right: 10px;
        text-align: right;
    }

    .onoffswitch-inner:after,
    .onoffswitch-inner:before {
        box-sizing: border-box;
        color: #fff;
        float: left;
        font-size: 15px;
        font-weight: 700;
        height: 15px;
        line-height: 15px;
        padding: 0;
        width: 50%;
    }

input[type=checkbox] {
    cursor: pointer;
    margin: 0 0.5rem 0 0;
    position: relative;
    top: 0;
}

.onoffswitch-checkbox {
    display: none;
}

#image_preview {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(160px, 160px));
    width: 100%;
    gap: 20px;
}

.image-box-actions {
    text-align: center;
    margin: 10px 0;
}

    .image-box-actions a {
        border: 1px solid #eee;
        padding: 5px 20px;
        text-transform: uppercase;
        font-size: 14px;
    }

        .image-box-actions a:hover {
            box-shadow: 1px 1px 180px #dc3545 inset;
            color: #fff !important;
        }

</style>
<!-- Content Header (Page header) -->
<section class="content-header">
    <div class="container-fluid">
        <div class="row mb-2">
            <div class="col-sm-6">
                <h1>New Blog</h1>
            </div>
            <div class="col-sm-6">
                <ol class="breadcrumb float-sm-right">
                    <li class="breadcrumb-item"><a href="#">Dashboard</a></li>
                    <li class="breadcrumb-item active">New Blog</li>
                </ol>
            </div>
        </div>
    </div><!-- /.container-fluid -->
</section>

<!-- Main content -->
<section class="content">
    <div class="container-fluid">
        <form action="AddBlog" method="post" enctype="multipart/form-data">
            <div class="row">
                <!-- left column -->
                <div class="col-md-9">
                    <!-- general form elements -->
                    <div class="card card-danger">
                        <div class="card-header">
                            <h3 class="card-title">Blog Details</h3>
                        </div>
                        <!-- /.card-header -->
                        <div class="card-body">
                            <div class="form-group">
                                <label for="Name">Name <span class="text-danger">*</span></label>
                                <input type="text" asp-for="Title" class="form-control" id="Name" placeholder="Enter Blog Title">
                                <span asp-validation-for="Title" class="text-danger"></span>
                            </div>
                            <div class="form-group">
                                <label for="exampleInputPassword1">Description</label>
                                <div id="the-count">
                                    <span id="maximum">(400 character(s) remain)</span>
                                </div>
                                <textarea class="form-control" asp-for="Description" rows="4" maxlength="400" placeholder="Short description"
                                          data-counter="400" name="description" cols="50" id="description"></textarea>
                                <span asp-validation-for="Description" class="text-danger"></span>
                            </div>
                            <div class="form-group">
                                <label for="is_featured" class="control-label">Is featured?</label>
                                <div class="onoffswitch">
                                    <input type="hidden" asp-for="Featured" id="featured" value="0">
                                    <input type="checkbox" class="onoffswitch-checkbox" name="is_featured" id="is_featured" value="1">
                                    <label class="onoffswitch-label" for="is_featured">
                                        <span class="onoffswitch-inner"></span>
                                        <span class="onoffswitch-switch"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="exampleInputPassword1">Content</label>
                                <textarea id="editor" asp-for="BlogContent" class="form-control"></textarea>
                            </div>
                        </div>
                    </div>
                    <!-- /.card -->
                    <!-- general form elements -->
                    <div class="card card-danger">
                        <div class="card-header">
                            <h3 class="card-title">Gallery Images</h3>
                        </div>
                        <!-- /.card-header -->
                        <div class="card-body">
                            <div class="form-group">
                                <input type="file" asp-for="Blogimages" id="Images" accept="image/png, image/jpeg"
                                       onchange="readImages(this);" style="display:none" multiple />
                                <div id="image_preview">
                                    <div class="preview-image-wrapper">
                                        <img src="https://ultranews.thesky9.com/vendor/core/core/base/images/placeholder.png"
                                             data-default="https://ultranews.thesky9.com/vendor/core/core/base/images/placeholder.png"
                                             alt="Preview image" class="preview_image" width="150">
                                        <a class="btn_remove_image" title="Remove image">
                                            <i class="fa fa-times"></i>
                                        </a>
                                    </div>
                                </div>
                                <div class="image-box-actions">
                                    <a href="javascript:void(0);" class="btn_gallery" onclick="$('#Images').trigger('click');"
                                       data-result="image" data-action="select-image" data-allow-thumb="1">
                                        Choose image
                                    </a>
                                </div>
                            </div>
                        </div>
                        <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                </div>
                <!--/.col (left) -->
                <!-- right column -->
                <div class="col-md-3">
                    <!-- Form Element sizes -->
                    <div class="card card-danger">
                        <div class="card-header">
                            <h3 class="card-title">
                                Publish
                            </h3>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <div class="row">
                                    <input type="hidden" id="ButtonType" name="ButtonType" value="" />
                                    <div class="col-md-5">
                                        <button type="submit" class="btn btn-primary" name="Save" style="font-size: 14px;">
                                            <i class="fa fa-save"></i>&nbsp;&nbsp;Save
                                        </button>
                                    </div>
                                    <div class="col-md-7" style="text-align: right;">
                                        <button type="submit" class="btn btn-success" name="SaveEdit" style="font-size: 14px;">
                                                <i class="fa fa-check-circle"></i>&nbsp;&nbsp;Save & Edit
                                            </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- /.card-body -->
                    </div>
                    <!-- /.card -->

                    <div class="card card-danger">
                        <div class="card-header">
                            <h3 class="card-title">
                                Publish date
                            </h3>
                        </div>
                        <div class="card-body">
                            <label for="exampleInputPassword1">Date</label>
                            <div class="row">
                                <div class="col-12">
                                    <div class="input-group mb-3">
                                        <input type="date" asp-for="Date" id="Date" class="form-control">
                                        <div class="input-group-append">
                                            <span class="input-group-text"><i class="fas fa-calendar-alt"></i></span>
                                        </div>
                                    </div>
                                        <span asp-validation-for="Date" class="text-danger"></span>
                                </div>
                            </div>
                            <label for="exampleInputPassword1">Time</label>
                            <div class="row">
                                <div class="col-12">
                                    <div class="input-group mb-3">
                                        <input type="time" asp-for="Time" id="Time" class="form-control">
                                        <div class="input-group-append">
                                            <span class="input-group-text"><i class="fas fa-clock"></i></span>
                                        </div>
                                    </div>
                                    <span asp-validation-for="Time" class="text-danger"></span>
                                </div>
                            </div>
                        </div>
                        <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                    <!-- general form elements disabled -->
                    <div class="card card-danger">
                        <div class="card-header">
                            <h3 class="card-title">
                                Status <span class="text-warning">*</span>
                            </h3>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-12">
                                    <div class="input-group mb-3">
                                        <select class="form-control ui-select ui-select" asp-for="Status">
                                            <option value="published" selected="selected">Published</option>
                                            <option value="draft">Draft</option>
                                            <option value="pending">Pending</option>
                                        </select>
                                        <span asp-validation-for="Status" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                    <!-- general form elements disabled -->
                    <div class="card card-danger">
                        <div class="card-header">
                            <h3 class="card-title">
                                Author <span class="text-warning">*</span>
                            </h3>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-12">
                                    <div class="input-group mb-3">
                                        <select class="form-control ui-select ui-select" asp-for="UserID" asp-items="@ViewBag.UserID" required>
                                        </select>
                                        <span asp-validation-for="UserID" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                    <!-- general form elements disabled -->
                    <div class="card card-danger">
                        <div class="card-header">
                            <h3 class="card-title">
                                Categories <span class="text-warning">*</span>
                            </h3>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-12">
                                    <div class="input-group mb-3">
                                        <ul id="CategoryList">
                                            @foreach (var item in @ViewBag.CategoryID)
                                            {
                                                <li value="@item.Id">
                                                    <label class="mb-2">
                                                        <input type="checkbox" id="@item.Id" value="@item.Id" name="CategoryID">
                                                        @item.Name
                                                    </label>
                                                </li>
                                            }
                                        </ul>
                                        <span class="text-danger">@ViewBag.Error</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                    <!-- general form elements disabled -->
                    <div class="card card-danger">
                        <div class="card-header">
                            <h3 class="card-title">
                                Image
                            </h3>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-12">
                                    <div class="input-group mb-3">
                                        <div class="image-box">
                                            <input type="file" asp-for="imageFile" id="Image" onchange="readURL(this);" style="display:none" />
                                            <div class="preview-image-wrapper">
                                                <img src="https://ultranews.thesky9.com/vendor/core/core/base/images/placeholder.png"
                                                     alt="Preview image" id="preview_image" title="Remove image" width="150"
                                                     data-default="https://ultranews.thesky9.com/vendor/core/core/base/images/placeholder.png" />
                                                <a class="btn_remove" title=""><i class="fa fa-times"></i></a>
                                            </div>
                                            <div class="image-box-actions">
                                                <a href="javascript:void(0);" class="btn_gallery" onclick="$('#Image').trigger('click');"
                                                   data-result="image" data-action="select-image" data-allow-thumb="1">
                                                    Choose image
                                                </a>
                                            </div>
                                            <span asp-validation-for="imageFile" class="text-danger"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                    <!-- general form elements disabled -->
                    <div class="card card-danger">
                        <div class="card-header">
                            <h3 class="card-title">
                                Comments
                            </h3>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-12">
                                    <div class="input-group mb-3">
                                        <div class="onoffswitch">
                                            <input type="hidden" asp-for="Comment" id="comments" value="0">
                                            <input type="checkbox" class="onoffswitch-checkbox" name="comment_status" id="comment_status" value="1">
                                            <label class="onoffswitch-label" for="comment_status">
                                                <span class="onoffswitch-inner"></span>
                                                <span class="onoffswitch-switch"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                </div>
                <!--/.col (right) -->
            </div>
            <!-- /.row -->
        </form>
    </div><!-- /.container-fluid -->
</section>
<!-- /.content -->
<!-- /.content -->
@section Scripts {
    <script>
        $(function () {
            bsCustomFileInput.init();
        });
        $("input[data-bootstrap-switch]").each(function () {
            $(this).bootstrapSwitch('state', $(this).prop('checked'));
        });
        const textarea = document.querySelector("textarea");

        textarea.addEventListener("input", event => {
            const target = event.currentTarget;
            const maxLength = target.getAttribute("maxlength");
            const currentLength = target.value.length;
            document.getElementById("maximum").innerText = `(${maxLength - currentLength} character(s) remain)`;
        });
        initSample();

        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();

                reader.onload = function (e) {
                    $('#preview_image')
                        .attr('src', e.target.result)
                        .width(150)
                        .height(200);
                };

                reader.readAsDataURL(input.files[0]);
            }
        }

        // Multiple images preview in browser
        var imagesPreview = function (input, placeToInsertImagePreview) {
            if (input.files) {
                var filesAmount = input.files.length;
                for (i = 0; i < filesAmount; i++) {
                    var reader = new FileReader();
                    reader.onload = function (event) {
                        document.getElementsByClassName("preview-image-wrapper")[0].style.display = 'none';
                        $("#image_preview").append(`<div class="preview-image-wrapper">` +
                            `<img src="${event.target.result}" alt="Preview image" class="preview_image" title="Remove image" width="150" data-default="${event.target.result}" />` +
                            `<a class="btn_remove_image" title=""><i class="fa fa-times"></i></a></div>`);
                        $(".btn_remove_image").click(function () {
                            $(this).parent(".preview-image-wrapper").remove();
                        });
                    }
                    reader.readAsDataURL(input.files[i]);
                }
            } else {
                $("#image_preview").html("<div class='preview-image-wrapper'><img src='https://ultranews.thesky9.com/vendor/core/core/base/images/placeholder.png' alt='Preview image' class='preview_image' title='Remove image' width='150' data-default='https://ultranews.thesky9.com/vendor/core/core/base/images/placeholder.png' /></div>");
            }
        };

        function readImages(input) {
            imagesPreview(input, 'div.preview-image-wrapper');
        }

        function RemoveImage(x) {
            let filesAmount = document.getElementsByClassName("preview-image-wrapper");
            filesAmount[x].remove();
        }

        $(".btn_remove").click(function () {
            $('#preview_image')
                .attr('src', 'https://ultranews.thesky9.com/vendor/core/core/base/images/placeholder.png')
                .css({
                    height: '150px',
                    maxWidth: '100%'
                });
            $("#Image").val('');
        });

        $("input:checkbox").on('click', function () {
            // in the handler, 'this' refers to the box clicked on
            var $box = $(this);
            if ($box.is(":checked")) {
                // the name of the box is retrieved using the .attr() method
                // as it is assumed and expected to be immutable
                var group = "input:checkbox[name='" + $box.attr("name") + "']";
                // the checked state of the group/box on the other hand will change
                // and the current value is retrieved using .prop() method
                $(group).prop("checked", false);
                $box.prop("checked", true);
            } else {
                $box.prop("checked", false);
            }
        });

        $("#comment_status").click(function () {
            if ($(this).prop("checked") == true) {
                $("#comments").val(1);
            }
            else if ($(this).prop("checked") == false) {
                $("#comments").val(0);
            }
        });

        $("#is_featured").click(function () {
            if ($(this).prop("checked") == true) {
                $("#featured").val(1);
            }
            else if ($(this).prop("checked") == false) {
                $("#featured").val(0);
            }
        });

        $("[name='Save']").click(function(){
            $("#ButtonType").val('Save');
        });

        $("[name='SaveEdit']").click(function(){
            $("#ButtonType").val('SaveEdit');
        });
    </script>
}
